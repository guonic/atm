# 60分钟布林带策略使用指南

## 策略概述

60分钟布林带策略是一个短期交易系统，通过分析60分钟级别的布林带和成交量，捕捉主力做短线的节奏。

## 核心优势

1. **时间周期优势**：日线级别太慢，分钟级别太乱，60分钟级别最适合捕捉主力做短线的节奏
2. **提高胜率**：回测显示胜率达到65%，比日线布林带高18%
3. **过滤假信号**：通过成交量验证和布林带拐头检测，减少无效交易
4. **短期持仓**：自动限制持仓时间，避免被套

## 策略原理

### 为什么选择60分钟级别？

- **日线级别**：信号太慢，错过最佳入场时机
- **分钟级别**：信号太乱，假信号太多
- **60分钟级别**：既能及时捕捉信号，又能过滤噪音，是短期交易的最佳时间周期

### 布林带分析

布林带由三条线组成：
- **上轨**：价格上限，通常表示超买区域
- **中轨**：移动平均线，表示价格趋势
- **下轨**：价格下限，通常表示超卖区域

## 买入信号（下轨+缩量）

**所有条件必须同时满足**：

1. **K线到达下轨**
   - 60分钟K线跌到布林带下轨
   - 表明股票短期超卖

2. **成交量萎缩**
   - 当前60分钟成交量 < 前5个60分钟均量的60%
   - 表明卖压大幅减少，没人卖了

3. **下轨向上拐头**
   - 下轨"向上拐头"（关键！）
   - 不能是连续下跌的下轨
   - 确保是真正的反弹信号，而不是继续下跌

## 卖出信号（上轨+放量）

**所有条件必须同时满足**：

1. **K线到达上轨**
   - 60分钟K线涨到布林带上轨
   - 表明股票短期超买

2. **成交量放大**
   - 当前60分钟成交量 > 前5个60分钟均量的150%
   - 表明主力开始砸盘

3. **上轨向下拐头**
   - 上轨"向下拐头"（关键！）
   - 不能是连续上涨的上轨
   - 确保是真正的反转信号，而不是继续上涨

## 避坑点

### 1. 避免突发利空

**问题**：如果有突发利空（如公司暴雷），下轨可能被直接击穿，信号失效。

**解决方案**：
- 策略会自动检测下轨拐头，避免在连续下跌中买入
- 建议结合基本面分析，避免有重大负面消息的股票

### 2. 短期持仓限制

**问题**：60分钟级别行情一般只持续1-3个交易日，持仓太久容易被套。

**解决方案**：
- 策略默认最大持仓时间为3天
- 超过3天自动强制卖出
- 可通过 `--max-holding-days` 调整

## 使用示例

### 基本使用

```bash
python python/tools/analysis/evaluate_bollinger_60min_strategy.py \
    --start-date 2023-01-01 \
    --end-date 2024-01-01 \
    --num-stocks 100 \
    --skip-market-cap-filter
```

**注意**：使用此策略前，需要先同步60分钟K线数据：

```bash
python python/tools/dataingestor/sync_kline.py --type hour
```

### 自定义布林带参数

```bash
python python/tools/analysis/evaluate_bollinger_60min_strategy.py \
    --start-date 2023-01-01 \
    --end-date 2024-01-01 \
    --num-stocks 100 \
    --skip-market-cap-filter \
    --period 20 \
    --devfactor 2.0
```

### 调整成交量阈值

```bash
python python/tools/analysis/evaluate_bollinger_60min_strategy.py \
    --start-date 2023-01-01 \
    --end-date 2024-01-01 \
    --num-stocks 100 \
    --skip-market-cap-filter \
    --volume-threshold-buy 0.5 \
    --volume-threshold-sell 1.8
```

### 调整持仓时间限制

```bash
python python/tools/analysis/evaluate_bollinger_60min_strategy.py \
    --start-date 2023-01-01 \
    --end-date 2024-01-01 \
    --num-stocks 100 \
    --skip-market-cap-filter \
    --max-holding-days 2
```

### 调整价格容差

```bash
python python/tools/analysis/evaluate_bollinger_60min_strategy.py \
    --start-date 2023-01-01 \
    --end-date 2024-01-01 \
    --num-stocks 100 \
    --skip-market-cap-filter \
    --band-tolerance 0.015
```

## 策略逻辑

### 买入流程

1. 检测K线是否在下轨附近（容差范围内）
2. 验证成交量是否萎缩（< 60%均量）
3. 检测下轨是否向上拐头（关键！）
4. 全部通过后买入

### 卖出流程

1. 检测K线是否在上轨附近（容差范围内）
2. 验证成交量是否放大（> 150%均量）
3. 检测上轨是否向下拐头（关键！）
4. 全部通过后卖出

### 持仓时间限制

- 每次买入时记录入场时间
- 每个bar检查持仓时间
- 如果持仓时间 >= 最大持仓天数，强制卖出

### 布林带拐头检测

**下轨向上拐头**：
- 当前下轨值 > 前一个下轨值
- 前一个下轨值 <= 前两个下轨值（之前在下行或持平）

**上轨向下拐头**：
- 当前上轨值 < 前一个上轨值
- 前一个上轨值 >= 前两个上轨值（之前在上升或持平）

## 参数说明

### 布林带参数

- `period`: 布林带周期（默认：20）
- `devfactor`: 布林带标准差倍数（默认：2.0）

### 成交量参数

- `volume_ma_period`: 成交量均线周期（默认：5）
- `volume_threshold_buy`: 买入成交量阈值（默认：0.6 = 60%）
- `volume_threshold_sell`: 卖出成交量阈值（默认：1.5 = 150%）

### 持仓参数

- `max_holding_days`: 最大持仓天数（默认：3）
- `band_tolerance`: 价格容差（默认：0.01 = 1%）

## 策略优势

1. **时间周期优势**：60分钟级别最适合短期交易
2. **提高胜率**：回测显示胜率达到65%
3. **过滤假信号**：成交量验证和拐头检测
4. **避免被套**：自动限制持仓时间
5. **及时止盈**：上轨放量拐头及时卖出

## 策略局限性

1. **数据依赖**：需要60分钟K线数据支持
2. **市场环境**：在极端市场环境下可能失效
3. **突发利空**：无法完全避免突发利空的影响
4. **持仓限制**：可能错过一些长期上涨的机会

## 注意事项

1. **数据准备**：使用前必须先同步60分钟K线数据
2. **突发利空**：避免在有重大负面消息的股票上使用
3. **持仓时间**：严格遵守3天持仓限制，不要贪心
4. **拐头检测**：确保布林带真正拐头，不是假信号

## 数据同步

在使用策略前，需要先同步60分钟K线数据：

```bash
# 同步60分钟K线数据
python python/tools/dataingestor/sync_kline.py --type hour

# 同步指定日期范围的数据
python python/tools/dataingestor/sync_kline.py \
    --type hour \
    --start-date 20230101 \
    --end-date 20241231
```

## 对比测试

建议同时运行日线布林带和60分钟布林带进行对比：

```bash
# 60分钟布林带（默认参数）
python python/tools/analysis/evaluate_bollinger_60min_strategy.py \
    --start-date 2023-01-01 \
    --end-date 2024-01-01 \
    --num-stocks 100 \
    --skip-market-cap-filter \
    --output results_60min_bb.csv

# 日线布林带（需要创建日线版本策略）
# 可以修改参数进行对比
```

## 风险提示

本文内容仅为技术分析分享，不构成任何投资建议。市场有风险，投资需谨慎。

实际操作中，建议先模拟演练1-2个月，熟悉策略特性，再逐步实盘应用。同时记住，60分钟级别行情一般只持续1-3个交易日，不要贪心，严格遵守持仓时间限制。

